# ğŸ“Š Architectuur Diagram - Inschrijfformulier

## Systeem Overzicht

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         STRAPI CMS                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚           Content Manager (Admin Panel)                â”‚    â”‚
â”‚  â”‚                                                         â”‚    â”‚
â”‚  â”‚  Page Dynamic Zone:                                    â”‚    â”‚
â”‚  â”‚  â”œâ”€ Hero                                               â”‚    â”‚
â”‚  â”‚  â”œâ”€ Features                                           â”‚    â”‚
â”‚  â”‚  â”œâ”€ ğŸ“ Signup Form (Zakelijk)    â†â”€ Configureerbaar   â”‚    â”‚
â”‚  â”‚  â”‚   â”œâ”€ Form Type: zakelijk                           â”‚    â”‚
â”‚  â”‚  â”‚   â”œâ”€ Show Company: âœ“                               â”‚    â”‚
â”‚  â”‚  â”‚   â”œâ”€ Pipedrive Enabled: âœ“                          â”‚    â”‚
â”‚  â”‚  â”‚   â””â”€ Heading, Button Text, etc.                    â”‚    â”‚
â”‚  â”‚  â”œâ”€ Pricing                                            â”‚    â”‚
â”‚  â”‚  â””â”€ ğŸ“ Signup Form (Particulier)  â†â”€ Configureerbaar   â”‚    â”‚
â”‚  â”‚      â”œâ”€ Form Type: particulier                         â”‚    â”‚
â”‚  â”‚      â”œâ”€ Show Company: âœ—                                â”‚    â”‚
â”‚  â”‚      â””â”€ Pipedrive Enabled: âœ“                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚           Lead Content Type (Database)                 â”‚    â”‚
â”‚  â”‚                                                         â”‚    â”‚
â”‚  â”‚  Stored Leads:                                         â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚ ID: 1                                         â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ Name: Jan de Vries                           â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ Email: jan@bedrijf.nl                        â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ Type: zakelijk                               â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ Company: Bedrijf BV                          â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ Pipedrive ID: 12345                          â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ Sync Status: âœ… synced                        â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚ ID: 2                                         â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ Name: Emma Jansen                            â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ Email: emma@email.com                        â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ Type: particulier                            â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ Pipedrive ID: 12346                          â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ Sync Status: âœ… synced                        â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“ API (REST)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        NEXT.JS APP                              â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚     Frontend Components                                â”‚    â”‚
â”‚  â”‚                                                         â”‚    â”‚
â”‚  â”‚     /components/dynamic-zone/signup-form.tsx          â”‚    â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”‚
â”‚  â”‚     â”‚  ğŸ“ Inschrijfformulier              â”‚          â”‚    â”‚
â”‚  â”‚     â”‚                                      â”‚          â”‚    â”‚
â”‚  â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚          â”‚    â”‚
â”‚  â”‚     â”‚  â”‚ Voornaam: [_______________]    â”‚ â”‚          â”‚    â”‚
â”‚  â”‚     â”‚  â”‚ Achternaam: [_____________]    â”‚ â”‚          â”‚    â”‚
â”‚  â”‚     â”‚  â”‚ Email: [___________________]   â”‚ â”‚          â”‚    â”‚
â”‚  â”‚     â”‚  â”‚ Telefoon: [________________]   â”‚ â”‚          â”‚    â”‚
â”‚  â”‚     â”‚  â”‚ Bedrijf: [_________________]   â”‚ â”‚ (zakelijk)
â”‚  â”‚     â”‚  â”‚ Bericht: [_________________]   â”‚ â”‚          â”‚    â”‚
â”‚  â”‚     â”‚  â”‚          [_________________]   â”‚ â”‚          â”‚    â”‚
â”‚  â”‚     â”‚  â”‚                                â”‚ â”‚          â”‚    â”‚
â”‚  â”‚     â”‚  â”‚      [ Verstuur ]              â”‚ â”‚          â”‚    â”‚
â”‚  â”‚     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚          â”‚    â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â”‚                                  â”‚
â”‚                              â†“ POST                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚     API Routes                                         â”‚    â”‚
â”‚  â”‚                                                         â”‚    â”‚
â”‚  â”‚     /app/api/leads/submit/route.ts                    â”‚    â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”‚
â”‚  â”‚     â”‚  1. Valideer data                    â”‚          â”‚    â”‚
â”‚  â”‚     â”‚  2. Sync naar Pipedrive              â”‚          â”‚    â”‚
â”‚  â”‚     â”‚  3. Opslaan in Strapi                â”‚          â”‚    â”‚
â”‚  â”‚     â”‚  4. Return response                  â”‚          â”‚    â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                       â”‚              â”‚                          â”‚
â”‚                       â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚               â”‚
â”‚  â”‚                                               â†“               â”‚
â”‚  â”‚    /lib/pipedrive.ts                                         â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚    â”‚  Pipedrive Helper Functions:         â”‚                 â”‚
â”‚  â”‚    â”‚  â€¢ createPerson()                    â”‚                 â”‚
â”‚  â”‚    â”‚  â€¢ createOrganization()              â”‚                 â”‚
â”‚  â”‚    â”‚  â€¢ createLead()                      â”‚                 â”‚
â”‚  â”‚    â”‚  â€¢ addNote()                         â”‚                 â”‚
â”‚  â”‚    â”‚  â€¢ syncLeadToPipedrive()             â”‚                 â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â†“ HTTPS API Calls
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PIPEDRIVE API                              â”‚
â”‚                                                                 â”‚
â”‚  Zakelijk Account (PIPEDRIVE_API_TOKEN_ZAKELIJK):             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Pipeline: Business Leads                              â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚  Lead: "Bedrijf BV - Jan de Vries"          â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  Person: Jan de Vries                       â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  Organization: Bedrijf BV                   â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  Note: "Bericht van website: ..."          â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â”‚  Particulier Account (PIPEDRIVE_API_TOKEN_PARTICULIER):       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Pipeline: Personal Leads                              â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚  Lead: "Emma Jansen"                        â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  Person: Emma Jansen                        â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  Note: "Interesse in product..."           â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow: Gebruiker vult formulier in

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Gebruiker   â”‚
â”‚   Website     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
        â”‚ Vult formulier in + klikt "Verstuur"
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SignupForm Component                        â”‚
â”‚  â€¢ Validate input                            â”‚
â”‚  â€¢ POST naar /api/leads/submit               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  /api/leads/submit Route Handler             â”‚
â”‚                                              â”‚
â”‚  Step 1: Validatie                          â”‚
â”‚  â”œâ”€ Check required fields                   â”‚
â”‚  â”œâ”€ Validate email format                   â”‚
â”‚  â””â”€ Check leadType (zakelijk/particulier)   â”‚
â”‚                                              â”‚
â”‚  Step 2: Pipedrive Sync (if enabled)        â”‚
â”‚  â”œâ”€ Get correct API token (zakelijk/part.)  â”‚
â”‚  â”œâ”€ Create Organization (if company)        â”‚
â”‚  â”œâ”€ Create Person                           â”‚
â”‚  â”œâ”€ Create Lead                             â”‚
â”‚  â””â”€ Add Note (if message)                   â”‚
â”‚     â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Success: pipedriveId âœ…   â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Failed: error message âŒ  â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                              â”‚
â”‚  Step 3: Strapi Opslag (ALWAYS)            â”‚
â”‚  â”œâ”€ POST naar /api/leads                    â”‚
â”‚  â”œâ”€ Save with sync status                   â”‚
â”‚  â””â”€ Return lead ID                          â”‚
â”‚                                              â”‚
â”‚  Step 4: Response                           â”‚
â”‚  â””â”€ { success: true, data: {...} }          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Success Message Shown                       â”‚
â”‚  âœ… "Bedankt! We nemen contact op."          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Environment Variabelen

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  .env.local (Next.js)                        â”‚
â”‚                                              â”‚
â”‚  PIPEDRIVE_API_TOKEN_ZAKELIJK    â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  PIPEDRIVE_API_TOKEN_PARTICULIER â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  STRAPI_API_TOKEN (optional)          â”‚   â”‚  â”‚
â”‚  NEXT_PUBLIC_STRAPI_URL              â”‚   â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”˜
                                       â”‚   â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                  â”‚                        â”‚
                  â†“                        â†“
         Pipedrive Zakelijk      Pipedrive Particulier
         API Token               API Token
         (voor B2B leads)        (voor B2C leads)
```

## CMS Configuratie Flow

```
Strapi Admin Panel
        â”‚
        â†“
Content Manager â†’ Page
        â”‚
        â†“
Dynamic Zone â†’ Add Component
        â”‚
        â”œâ”€â†’ Signup Form (Component)
        â”‚       â”‚
        â”‚       â”œâ”€ heading: "Schrijf je in"
        â”‚       â”œâ”€ formType: "zakelijk" of "particulier" â† BELANGRIJK
        â”‚       â”œâ”€ showCompanyField: true/false
        â”‚       â”œâ”€ showPhoneField: true/false
        â”‚       â”œâ”€ showMessageField: true/false
        â”‚       â”œâ”€ buttonText: "Verstuur"
        â”‚       â”œâ”€ successMessage: "Bedankt!"
        â”‚       â”œâ”€ backgroundColor: "white"/"gray"/"gradient"
        â”‚       â””â”€ pipedriveEnabled: true/false â† Sync on/off
        â”‚
        â†“
Save + Publish
        â”‚
        â†“
Website (Next.js) fetches page data via Strapi API
        â”‚
        â†“
DynamicZoneManager renders SignupForm component
        â”‚
        â†“
Gebruiker ziet formulier met alle configuratie opties!
```

## Foutafhandeling

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Scenario 1: Pipedrive is offline       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Formulier submit                    â”‚
â”‚  2. Pipedrive sync FAILS âŒ              â”‚
â”‚  3. Lead opgeslagen in Strapi âœ…         â”‚
â”‚     - pipedriveSyncStatus: "failed"     â”‚
â”‚     - pipedriveSyncError: "Connection   â”‚
â”‚       timeout"                          â”‚
â”‚  4. Success message getoond aan user âœ…  â”‚
â”‚  5. Admin kan later handmatig synce     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Scenario 2: Strapi is offline          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Formulier submit                    â”‚
â”‚  2. Pipedrive sync SUCCESS âœ…            â”‚
â”‚  3. Strapi opslag FAILS âŒ               â”‚
â”‚  4. Error message aan user              â”‚
â”‚  5. Lead WEL in Pipedrive               â”‚
â”‚     (niet verloren!)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Scenario 3: Ongeldige data             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Formulier submit met invalid email  â”‚
â”‚  2. Validatie FAILS in API route âŒ      â”‚
â”‚  3. Error: "Ongeldig e-mailadres"       â”‚
â”‚  4. NIETS opgeslagen (correct!)         â”‚
â”‚  5. User kan herstellen                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Structuur

```
next/components/dynamic-zone/
â”‚
â”œâ”€â”€ manager.tsx                 (Routes components)
â”‚   â””â”€â†’ Imports signup-form.tsx
â”‚
â””â”€â”€ signup-form.tsx             (Main component)
    â”‚
    â”œâ”€â”€ Props (from Strapi CMS):
    â”‚   â”œâ”€ heading
    â”‚   â”œâ”€ sub_heading
    â”‚   â”œâ”€ formType â† Determines Pipedrive API
    â”‚   â”œâ”€ showCompanyField
    â”‚   â”œâ”€ showPhoneField
    â”‚   â”œâ”€ showMessageField
    â”‚   â”œâ”€ buttonText
    â”‚   â”œâ”€ successMessage
    â”‚   â”œâ”€ privacyText
    â”‚   â”œâ”€ backgroundColor
    â”‚   â””â”€ pipedriveEnabled
    â”‚
    â”œâ”€â”€ State:
    â”‚   â”œâ”€ formData (user input)
    â”‚   â”œâ”€ isSubmitting (loading state)
    â”‚   â”œâ”€ isSuccess (show success message)
    â”‚   â””â”€ error (show error message)
    â”‚
    â””â”€â”€ Functions:
        â”œâ”€ handleChange() - Update form data
        â”œâ”€ handleSubmit() - Submit to API
        â””â”€ Render logic - Conditional fields
```

---

**Dit diagram geeft een volledig overzicht van de architectuur!** ğŸ‰
